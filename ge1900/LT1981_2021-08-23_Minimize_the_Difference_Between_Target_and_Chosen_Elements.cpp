
#include "../header/myheader.h"

class LT1981
{
public:

// D D

//        bitset<5000> p(1);
//        for (auto& r : mat) {
//            bitset<5000> tmp;
//            for (auto& i : r) {
//                tmp = tmp | (p << i);
//            }
//            swap(p,tmp);
//        }
//        int res = 10000;
//        for (int i = 0; i < 5000; ++i) {
//            if (p[i]) res = min(res, abs(i - target));
//        }
//        return res;


//int dp[71][70 * 70 + 1] = {[0 ... 70][0 ... 70 * 70] = INT_MAX};
//int dfs(vector<set<int>>& m, int i, int sum, int target) {
//    if (i >= m.size())
//        return abs(sum - target);
//    if (dp[i][sum] == INT_MAX)
//        for (auto it = begin(m[i]); it != end(m[i]); ++it) {
//            dp[i][sum] = min(dp[i][sum], dfs(m, i + 1, sum + *it, target));
//            if (dp[i][sum] == 0 || sum + *it > target)
//                break;
//        }
//    return dp[i][sum];
//}
//int minimizeTheDifference(vector<vector<int>>& mat, int target) {
//    vector<set<int>> m;
//    for (auto &row : mat)
//        m.push_back(set<int>(begin(row), end(row)));
//    return dfs(m, 0, 0, target);
//}


//    bool bt[70 * 70 + 1] = {};
//    int max_e = 0, res = INT_MAX;
//    for (auto & row : mat) {
//        bool bt1[70 * 70 + 1] = {};
//        int max_e1 = 0;
//        for (auto i : unordered_set(begin(row), end(row))) {
//            for (int j = 0; j <= max_e; ++j)
//                if (j == max_e || bt[j]) {
//                    bt1[i + j] = true;
//                    max_e1 = max(max_e1, i + j);
//                }
//        }
//        swap(bt, bt1);
//        max_e = max_e1;
//    }
//    for (int i = 0; i <= 70 * 70; ++i) {
//        if (bt[i])
//            res = min(res, abs(i - target));
//    }
//    return res;




//Runtime: 1352 ms, faster than 5.88% of C++ online submissions for Minimize the Difference Between Target and Chosen Elements.
//Memory Usage: 63.4 MB, less than 5.88% of C++ online submissions for Minimize the Difference Between Target and Chosen Elements.
// the sum of the chosen elements
    int lt1981a(vector<vector<int>>& mat, int target)
    {
        unordered_set<int> set2;
        int sz1 = mat.size();
        int sz2 = mat[0].size();
        set2.insert(0);
        int mx = target + 72;
        int mnSum = 0;

        for (int i = 0; i < sz1; ++i)
        {
            unordered_set<int> set3;

            int mn = INT_MAX;
            for (int j = 0; j < sz2; ++j)
            {
                mn = min(mn, mat[i][j]);
            }
            #ifdef __test
//            cout<<"     "<<mn<<endl;
            #endif // __test
            mnSum += mn;
            for (int val : set2)
            {
//                int mn = INT_MAX;
                for (int j = 0; j < sz2; ++j)
                {
                    mn = min(mn, mat[i][j]);
                    int t2 = val + mat[i][j];
                    if (t2 <= mx)
                    {
                        set3.insert(t2);
                    }
                }
                #ifdef __test
//                cout<<"     "<<mn<<endl;
                #endif // __test
//                mnSum += mn;
            }
            swap(set2, set3);
        }
        int ans = target + 72;
        for (int i : set2)
        {
            #ifdef __test
//            cout<<i<<", ";
            #endif // __test
            ans = min(ans, abs(i - target));
        }
        #ifdef __test
//        cout<<endl<<", "<<set2.size()<<endl;
//        cout<<mnSum<<endl;
        #endif // __test
        if (set2.empty())
            ans = mnSum - target;
        return ans;
    }

};

int main()
{
//    myvvi vv = {{1,2,3},{4,5,6},{7,8,9}};
//    int tar = 13;

//    myvvi vv = {{1},{2},{3}};
//    int tar = 100;

//    myvvi vv = {{1,2,9,8,7}};
//    int tar = 6;

//    myvvi vv = {{34,27,41,28,39,21,10,42,26,50,32,7,34,22,15,48,35,9,39,17,41,2,26,13,7,21,39,10,50,3,14,15,29,15,49,13,18,20}
//    ,{3,1,49,50,16,14,32,25,27,30,16,41,33,44,44,3,39,10,47,4,22,47,33,11,18,40,45,9,24,30,21,34,22,41,33,29,49,23},
//    {12,23,20,24,38,26,47,8,1,40,14,4,35,3,11,26,34,14,34,28,18,23,32,26,13,25,25,20,49,37,2,50,23,10,16,42,28,10},
//    {12,48,33,10,39,36,32,19,41,1,41,23,13,45,31,44,49,42,37,4,25,35,34,33,36,29,37,9,20,15,20,35,20,3,13,4,13,8},
//    {3,40,41,6,1,23,16,47,17,27,43,20,5,29,47,47,34,14,9,5,47,43,40,14,35,8,11,18,10,25,30,22,45,39,26,34,22,48},
//    {29,10,45,34,3,36,21,13,2,9,42,23,4,45,4,20,4,3,47,32,36,39,28,11,8,38,3,32,20,3,34,39,24,1,11,9,47,1},
//    {41,49,45,30,19,23,41,34,12,5,42,42,44,1,3,15,7,23,25,24,25,24,5,6,41,37,26,11,9,10,37,43,19,44,10,4,9,17},
//    {42,24,27,21,23,28,34,25,27,48,48,25,23,39,8,15,6,34,1,15,36,9,5,50,45,12,2,4,35,22,17,44,44,14,6,7,29,7},
//    {13,47,23,24,14,3,21,16,38,22,34,46,41,23,42,1,33,33,22,39,1,37,34,33,8,2,41,13,33,3,45,15,47,27,8,14,36,37},
//    {48,12,33,46,3,24,7,35,37,32,10,36,19,35,3,48,15,1,19,33,14,12,22,28,18,25,39,12,10,39,43,8,4,46,2,48,5,18},
//    {23,20,10,47,27,14,25,15,15,17,20,27,24,37,16,48,21,34,42,41,17,8,50,18,21,20,47,32,11,18,18,49,29,23,21,39,10,23},{28,12,5,11,5,45,50,16,21,6,11,19,8,27,9,18,39,19,3,5,17,19,26,26,7,7,30,35,11,50,36,1,4,40,9,21,46,16},{4,36,32,5,5,6,31,35,38,40,35,35,25,43,14,38,1,22,37,22,38,25,15,22,15,4,5,4,39,8,20,8,14,21,14,4,25,22},{5,35,33,28,45,18,8,7,22,9,20,43,22,18,10,29,32,22,25,31,24,42,29,21,28,43,30,46,40,34,36,48,22,40,24,19,32,48},{24,11,21,22,27,9,1,17,21,7,19,35,26,19,7,41,7,7,15,27,41,15,37,4,34,40,2,29,44,44,16,46,4,10,35,31,32,9},{21,18,27,31,24,39,16,27,22,3,5,42,32,7,20,34,49,9,10,40,20,38,22,28,18,9,39,37,29,35,17,48,26,7,4,38,14,15},{41,14,48,4,39,23,40,6,21,24,34,49,42,25,44,27,45,6,39,37,48,3,17,19,1,14,42,26,20,14,23,8,28,39,20,5,16,29},
//    {23,36,34,48,30,12,38,2,38,23,45,31,22,30,31,27,36,40,29,8,3,25,28,50,13,28,8,31,35,28,37,24,15,12,24,35,37,34},{33,11,12,46,50,9,42,37,30,12,22,9,26,15,45,44,13,50,22,48,30,17,17,1,37,33,28,32,13,22,30,28,1,43,6,20,18,7},{42,49,48,19,23,31,24,7,29,3,21,39,49,27,50,22,24,32,30,1,35,35,29,1,33,22,45,25,41,8,50,2,27,29,2,24,26,46},{44,46,44,22,14,12,8,18,42,31,40,48,3,26,38,4,32,40,49,41,36,43,12,5,21,4,41,33,46,38,45,7,17,33,33,4,48,22}
//    ,{33,8,34,10,14,28,5,22,48,35,6,32,35,19,47,10,42,26,3,7,22,21,41,30,11,50,47,40,44,4,47,16,46,43,7,10,26,16},{3,33,49,41,44,2,24,41,19,22,22,25,49,47,15,38,6,26,18,17,32,28,8,48,22,37,20,36,11,39,41,44,29,44,33,42,19,14},{22,8,14,49,30,16,17,9,33,4,22,4,17,9,48,33,13,39,28,24,9,48,46,2,31,20,12,23,7,21,16,42,22,48,26,41,16,26},
//    {4,4,19,18,38,13,35,32,46,41,29,28,50,1,1,28,10,18,37,48,12,23,28,39,25,2,48,41,30,12,19,42,38,42,2,44,16,48},{24,25,23,18,19,22,5,27,43,29,49,49,47,28,31,7,18,22,49,7,30,22,28,5,12,24,14,10,26,39,36,26,31,6,16,21,6,35},{35,44,1,41,4,30,40,8,14,34,35,38,5,31,31,24,28,23,33,34,8,5,41,30,42,33,18,24,37,30,48,17,16,29,23,27,16,19},{7,1,39,49,38,40,12,9,30,42,35,17,5,12,17,31,7,30,11,31,10,26,48,6,28,44,43,16,31,48,36,45,35,28,10,12,42,28},{38,34,50,1,43,34,47,44,35,49,32,3,21,50,2,33,35,35,48,1,30,13,32,28,17,16,3,45,33,15,33,27,47,31,14,39,9,8},{35,19,21,10,3,36,48,17,12,5,30,20,31,28,9,22,12,34,11,26,17,7,37,12,23,40,40,23,7,19,38,31,22,40,39,41,22,42},{49,5,20,2,10,8,35,43,16,18,7,45,17,48,7,10,41,49,47,32,47,13,41,8,41,6,8,13,8,22,26,22,6,26,17,13,45,8},
//    {8,16,44,45,46,37,4,2,14,50,8,23,30,32,48,36,3,4,50,44,19,20,4,28,6,12,14,35,24,2,48,39,33,9,36,10,13,38},{41,11,9,7,39,45,11,46,15,38,49,20,36,10,22,20,12,12,24,44,24,39,1,22,23,18,48,17,15,24,11,9,5,20,28,44,1,25},{1,40,24,5,4,33,35,27,50,32,14,2,27,7,30,49,39,29,23,43,45,20,9,49,31,30,43,37,15,27,48,49,33,12,16,31,22,6},{35,21,42,9,39,29,25,23,29,48,4,1,42,15,24,6,31,48,31,16,6,33,10,9,50,35,29,33,13,28,12,18,11,14,25,2,46,22},{36,25,45,42,3,8,19,33,19,19,28,19,4,1,1,6,27,9,5,36,14,30,4,25,39,2,2,41,46,25,8,12,28,24,25,20,13,49}
//    ,{9,32,43,15,49,3,31,9,16,12,14,40,31,38,32,31,9,5,6,26,17,25,15,35,1,27,40,41,50,14,28,29,20,12,19,26,5,43},
//    {45,28,41,6,25,41,44,49,12,24,24,26,49,18,24,30,8,50,45,11,41,27,43,17,47,22,2,13,43,5,20,46,30,49,23,8,29,24},{48,27,47,27,13,34,44,40,40,41,35,42,38,48,11,37,17,23,37,12,18,9,4,5,41,44,14,7,35,3,32,28,40,15,33,21,38,35},{34,8,26,41,33,17,11,50,50,15,1,12,45,39,26,32,7,6,4,15,23,8,42,8,22,27,3,44,20,26,41,30,12,33,42,26,20,36},{46,13,17,4,7,37,41,44,1,16,18,6,28,49,29,8,24,16,41,23,17,49,5,25,46,2,46,11,49,8,17,47,27,13,30,2,25,9},{35,36,38,8,5,2,35,43,45,20,34,3,40,6,20,6,29,47,7,23,25,40,2,37,30,10,44,35,14,35,31,8,40,21,4,19,14,1},{17,30,44,10,31,35,6,21,5,48,42,15,8,24,15,7,21,46,8,1,8,33,40,37,33,10,22,36,9,33,5,4,13,32,13,9,44,49},
//    {16,32,28,42,21,12,16,2,12,29,20,46,26,32,22,13,27,5,46,20,28,23,30,17,13,28,13,4,50,9,2,41,18,19,25,31,12,47},{44,11,48,11,7,17,4,10,46,50,20,30,44,21,5,19,36,49,21,42,25,36,4,3,26,28,20,45,41,49,15,21,29,4,38,44,3,30}};
//    int tar = 20;

    myvvi vv = {{36,19,25,23,50,25,34,49,26,44,30,40,44,18,21,19,33,31,23,44,11,8,33,10,23,21,12,4,12,31,2,16,8,36,38,43,40,10,7,6},{39,12,36,22,44,8,48,28,41,34,16,4,34,44,35,48,28,25,19,3,36,45,24,23,20,39,24,6,3,22,24,24,20,10,28,26,21,20,19,23},{10,49,42,22,17,49,11,10,33,12,21,4,32,26,18,1,40,27,13,13,11,43,5,11,47,44,15,10,41,14,2,47,37,1,16,12,43,9,21,40},{6,46,15,44,34,27,48,10,12,25,4,26,2,23,6,7,40,4,15,11,35,13,43,9,28,5,15,37,45,7,20,41,8,39,45,16,34,33,27,12},{28,9,33,30,40,38,13,14,16,41,47,5,27,24,37,24,50,19,23,3,17,25,37,7,34,30,33,45,19,44,32,8,15,35,16,47,3,6,27,48},{25,2,28,1,1,42,1,8,31,22,22,23,6,44,3,42,15,33,10,6,27,39,12,13,18,28,2,33,21,16,2,15,6,37,46,19,33,12,5,9},{15,12,43,34,34,29,13,41,25,47,21,48,49,43,21,30,16,10,24,47,38,43,8,48,6,36,5,41,42,49,50,36,22,24,1,43,11,3,5,16},{18,46,25,6,6,15,7,49,18,39,21,39,6,44,19,15,14,16,23,29,5,24,31,45,7,34,20,44,21,48,23,3,4,49,1,46,21,22,46,28},{17,36,5,14,6,49,8,38,9,32,5,45,22,44,11,42,45,23,23,47,30,9,6,12,16,18,2,9,19,24,19,49,8,19,46,8,23,15,4,30},{4,22,13,37,6,42,5,7,29,14,43,8,12,25,20,1,9,27,12,21,37,9,21,33,39,27,45,28,41,38,2,40,39,19,50,33,45,32,27,6},{7,28,47,39,18,18,49,32,4,24,37,43,26,21,3,22,10,32,46,25,6,17,14,31,9,50,10,2,14,39,11,11,11,28,22,16,15,36,37,9},{16,47,42,34,34,43,36,12,17,32,40,32,33,35,15,26,32,34,12,4,38,7,13,37,44,37,11,26,37,36,34,25,9,28,26,26,2,42,16,15},
    {19,13,13,20,45,39,10,37,16,49,15,5,37,21,26,20,33,26,3,25,32,40,34,38,44,5,29,16,23,27,35,30,41,7,1,46,2,43,4,2},{44,35,5,46,18,44,6,43,1,50,39,36,50,37,9,40,48,31,4,4,6,43,1,21,17,15,14,10,39,17,19,6,24,14,39,21,28,44,11,13},{10,50,38,22,46,29,39,38,3,28,33,29,23,50,33,34,23,22,38,15,7,30,49,33,4,49,25,14,30,9,9,12,50,46,48,20,30,12,21,32}
    ,{18,26,49,4,37,46,31,45,37,18,34,39,5,46,16,24,14,15,9,4,43,26,6,7,50,14,17,4,45,12,5,46,16,19,40,43,8,41,34,24},{28,13,20,28,16,25,47,27,16,39,23,2,36,33,49,23,33,3,23,49,29,41,34,41,15,24,14,45,25,46,34,25,37,15,15,14,45,50,2,37},{3,1,18,19,4,35,45,22,36,13,26,40,47,44,5,30,29,21,40,33,39,32,42,42,40,33,24,49,25,21,32,35,23,9,17,6,48,24,9,17},{25,37,38,12,42,28,38,16,24,22,34,3,5,16,27,22,26,14,15,30,37,10,37,13,7,20,47,37,35,33,27,10,44,50,14,47,42,4,9,27},{21,43,4,6,41,28,40,24,38,17,25,4,20,39,32,19,16,46,40,10,6,43,16,45,49,39,47,25,1,33,33,35,2,24,34,10,18,40,17,50},{10,43,30,25,4,44,32,37,5,46,38,46,19,31,8,40,41,4,38,23,36,30,13,36,24,8,12,13,39,31,8,49,2,48,20,41,8,33,30,33},
    {9,2,46,24,7,46,34,34,40,34,5,36,23,45,23,47,27,10,35,5,49,48,9,27,44,1,14,17,28,12,27,37,33,20,45,41,8,12,49,34},{36,23,4,22,36,1,32,27,10,23,23,10,50,47,32,47,32,24,40,45,40,17,48,18,20,16,22,25,30,42,50,2,28,42,50,39,13,12,32,47},{1,47,37,49,10,26,9,32,12,45,38,44,4,8,30,48,19,6,43,32,47,30,39,6,45,5,19,47,19,16,7,34,33,30,7,10,13,27,42,9},{17,19,44,50,29,39,33,21,37,36,4,50,26,18,41,47,50,5,28,32,29,33,38,35,30,10,12,31,14,23,14,34,17,20,8,7,32,45,11,34},{1,45,20,38,1,11,38,29,18,24,40,11,1,13,46,16,48,46,7,14,28,42,26,31,47,24,16,14,37,5,44,31,48,10,44,46,23,12,33,10},{23,13,25,2,22,29,49,21,33,28,2,47,25,46,50,27,29,45,22,49,10,9,28,31,2,30,7,50,4,21,43,32,49,33,19,37,23,39,34,28},{27,14,5,43,3,16,20,41,27,49,40,46,31,44,24,13,11,13,24,2,49,18,15,15,24,23,27,16,33,40,16,8,47,27,38,21,31,3,2,42},{30,24,43,30,45,26,6,28,3,9,12,6,31,33,31,20,39,27,16,39,25,14,6,24,28,6,27,21,7,40,39,31,6,2,14,41,21,17,11,19},{38,5,16,13,10,10,13,35,3,29,9,4,19,12,21,3,46,17,31,47,14,7,40,12,22,31,3,13,2,13,8,27,15,49,32,24,2,16,15,46},{46,18,23,4,50,33,17,39,41,16,18,12,42,22,47,46,27,5,18,38,41,28,35,9,24,39,10,43,45,6,49,15,33,24,12,47,37,32,11,12},{43,9,34,30,11,31,32,1,27,31,36,49,42,41,46,16,4,40,49,8,18,30,11,7,18,46,14,20,10,17,4,18,18,18,41,34,40,33,39,2},{31,20,37,24,22,10,25,33,44,24,21,26,49,48,36,28,37,21,37,42,7,39,2,11,30,30,7,30,48,37,10,10,9,25,40,11,14,45,47,2}
    ,{31,35,40,22,7,49,27,18,28,7,45,29,50,14,11,32,12,6,6,14,43,28,37,36,5,29,27,5,10,2,8,11,3,6,23,33,38,46,35,44},{9,46,8,29,5,38,35,36,40,6,48,17,24,50,37,29,9,38,23,15,34,1,29,18,33,49,47,19,39,10,49,12,47,31,44,15,3,20,31,23},{15,11,26,50,30,25,18,20,33,46,27,39,28,29,30,34,29,18,18,41,34,46,10,40,20,24,46,42,13,7,13,49,34,43,32,48,30,36,45,31},{43,50,29,39,39,40,2,14,35,40,22,37,6,6,16,42,31,23,26,33,37,6,31,7,49,32,41,40,4,4,27,44,11,44,31,12,26,40,1,12}
    ,{5,6,26,30,44,21,12,17,8,8,16,48,24,9,25,46,31,6,29,14,49,5,10,1,38,47,9,23,16,11,26,19,20,32,1,32,31,38,29,7},{31,16,5,14,19,48,18,14,49,49,29,20,35,28,21,45,26,7,48,29,39,41,22,6,45,8,42,45,26,19,43,45,11,49,11,29,15,35,16,48},{2,40,50,1,35,32,48,47,34,43,11,28,22,3,21,37,21,44,39,32,1,42,20,4,31,26,21,15,24,35,9,12,46,34,22,47,40,25,8,1},{39,14,36,27,29,46,38,6,28,19,28,19,5,45,38,22,38,1,8,35,29,2,10,19,27,5,29,28,4,1,24,25,29,28,50,31,43,2,20,13},{50,40,17,48,18,41,24,36,17,6,27,26,10,14,6,25,6,33,35,10,36,8,28,3,9,32,11,3,8,40,24,49,24,2,25,46,11,43,38,33},{17,34,14,21,4,13,20,33,21,10,13,23,30,37,25,36,4,47,32,50,47,45,5,20,20,42,28,27,40,38,12,6,26,19,28,30,12,44,47,44},
    {46,19,25,42,48,24,37,34,4,22,46,35,23,22,34,6,43,31,43,27,48,20,11,42,41,32,38,27,3,25,3,37,29,43,22,32,32,25,48,15},{3,24,15,1,3,30,41,39,17,46,16,28,29,50,26,32,10,39,39,5,27,50,17,47,21,50,41,2,15,18,20,38,36,10,35,36,20,48,20,29},{19,32,4,27,10,12,39,47,23,32,11,3,8,14,19,9,38,27,37,30,41,27,36,41,18,29,16,39,24,48,34,46,21,40,32,38,17,6,21,33},{10,43,15,5,48,3,30,5,19,39,21,14,38,44,24,41,37,8,20,20,18,30,20,17,34,22,41,32,2,16,4,31,36,13,26,40,25,29,15,11},{4,14,30,3,40,37,8,6,27,16,8,12,41,38,1,7,10,44,6,32,48,28,35,1,7,8,34,10,34,7,12,19,30,39,5,11,38,18,42,36},
    {23,20,21,10,6,1,1,41,40,11,13,33,44,31,30,35,11,13,13,23,35,22,34,31,46,29,42,32,35,45,30,26,38,33,33,6,50,12,17,34}};
    int tar = 17;

    LT1981 lt;

    cout<<lt.lt1981a(vv, tar)<<endl;

    return 0;
}
