
#include "../header/myheader.h"

class LT2577
{
public:




    // tle, 每次都-2, 不知道什么情况。

    // 每次等待 是 +2.  无法+1等待。
    // 每 2个点 之间 ，如果 曼哈顿距离是 偶数， 那么 这2点间的 任意path 长度都是 偶数 ？
    int lt2577a(vector<vector<int>>& grid)
    {
        int sz1 = grid.size();
        int sz2 = grid[0].size();

        // the time go into this cell
        vector<vector<int>> vvi(sz1, vector<int>(sz2, -1));
        vvi[0][0] = 0;

        if (sz2 > 1 && grid[0][1] <= 1)
            dfsa1(grid, vvi, 0, 1, 1);
        if (sz1 > 1 && grid[1][0] <= 1)
            dfsa1(grid, vvi, 1, 0, 1);

        return vvi[sz1 - 1][sz2 - 1];
    }

    void dfsa1(vector<vector<int>>& grid, vector<vector<int>>& vvi, int r, int c, int tm)
    {
        if (r == -1 || c == -1 || r == vvi.size() || c == vvi[0].size())
            return;

        if (tm < grid[r][c])
        {
            tm += (grid[r][c] - tm + 1) / 2 * 2;
        }

        if (vvi[r][c] != -1 && vvi[r][c] <= tm)
            return;

#ifdef __test
        // ?? 这是什么情况？ 每次 - 2。。。
        if (r == 8 && c == 53)
        cout << r << " - " << c << " . " << vvi[r][c] << " vs " << tm << endl;
#endif


        vvi[r][c] = tm;

        int arr[5] = { 1,0,-1,0,1 };
        for (int i = 0; i < 4; ++i)
            dfsa1(grid, vvi, r + arr[i], c + arr[i + 1], tm + 1);

    }

};

int main()
{

    LT2577 lt;

    //myvvi vv = { {0,1,3,2},{5,1,2,5},{4,3,8,6} };

    myvvi vv = { {0,0,30340,27966,65071,12205,99289,24559,70651,87630,92892,77981,95673,85707,83658,97844,67688,48589,66341,64120,3725,23702,9320,14395,95527,43020,34562,30851,41532,9061,43032,64409,69547,71407,48007,3869,55894,1906,13938,61291,31598,57871,74082,69610,4394,86886,25816,48005,23304,68178,58777,42889,84999,5300},{0,55321,70434,52110,39186,93003,36735,57913,94036,27405,5672,16928,37761,231,63840,72156,28018,40634,26223,78521,24239,51656,5221,35641,71232,73186,24427,83821,28316,96271,9142,42907,13200,31934,
57063,52688,9379,48554,28420,21398,9979,12653,62284,63289,91963,28529,79033,29249,32775,67851,55108,32355,41600,21025},{80329,40981,10437,14356,72432,74122,54889,67714,68608,27710,53145,30460,52059,31339,78630,97336,92901,31824,62635,50604,51333,66071,96582,11929,22487,26710,49170,54767,12912,65685,70013,6707,61824,55493,15231,87144,16136,8118,22705,71971,67187,96179,65537,29998,84551,82228,15487,71919,90385,94958,87356,37738,72258,15723},{53104,68774,33212,72026,73572,26378,71911,11901,4950,80864,33311,68803,87532,52803,98601,84949,73023,69960,48754,1840,
16410,52251,30289,7723,87322,98074,13556,62805,44385,21135,54902,33382,23788,95502,39498,10940,38250,64722,2354,66252,4892,15397,57830,11916,36800,91881,4407,60406,39092,27822,45507,86587,8487,26735},{37572,58947,26835,25670,42142,37600,59374,19225,25783,76889,28565,49995,53166,95330,45545,2091,76083,17227,36692,85698,12665,82010,85470,12537,87570,92896,8352,89664,99950,31374,67981,37849,45436,88691,61915,24854,85335,90373,73251,88139,42440,97157,58819,94027,96150,83938,15301,84850,77036,94803,16739,86471,39143,84873},{89488,59564,36386,78994,36503,65709,35940,83595,92366,32821,
16191,37583,72003,76388,85586,64952,48222,69212,84630,92484,72650,46115,31213,33900,76839,78505,54379,21929,32517,12882,79758,83305,93892,21496,50037,64785,40241,72908,2058,8738,51946,3667,54150,77772,87593,22783,70733,51688,51990,47274,71363,89190,38040,10270},{14837,35181,96354,22416,53700,24167,12083,20815,29268,68769,43010,51458,48438,96643,50747,71349,2256,84498,44786,90024,46589,72480,21525,11343,98336,7887,54938,59796,5291,26183,62685,56436,99287,59885,93706,7052,90002,53978,4045,14563,4920,43899,71594,76739,64111,98068,92662,2963,93940,58092,71905,25168,71431,25658},{3376,46143,66103,94004,10718,95749,31114,43635,95932,60045,
4068,75531,27603,1590,44270,50613,61992,76347,65752,28215,21271,63116,38461,30061,26303,48237,57614,98838,72273,53356,24327,5332,52563,60094,40120,96077,27261,14199,54129,6114,64829,79810,90979,8143,39794,24270,70435,42695,15032,1675,65274,70548,59028,86048},{53664,56766,36571,59696,35572,64273,12125,26193,57426,43979,9274,7798,9744,9472,92148,82925,356,29201,89452,69502,80722,29110,62127,95827,51052,9783,716,62254,32511,80563,46707,3993,40509,2069,20129,8985,30016,22532,75029,8662,27832,53861,24437,87607,51427,4280,8451,27944,16905,11136,70777,39100,69607,58048},{63599,36503,
35211,78835,20843,52363,51787,61217,41561,24486,35180,28632,68993,6895,87420,34002,50962,12520,86477,83708,40552,44903,49018,30985,37040,4597,13174,77994,72886,69999,36401,23986,35665,35613,88225,57076,29502,26739,3788,45707,62869,95459,48642,52347,60873,10166,604,5950,29416,39766,88821,1855,69413,68856},{33835,44542,92375,1752,58268,65515,31660,88643,58775,37917,49490,56880,11826,28760,89199,86992,48378,17951,91714,58585,53201,79612,80599,25761,35528,49566,32022,33162,85450,18595,61594,96068,6643,12048,2394,45709,95462,64476,66932,63881,822,63676,87501,44028,61778,7891,49238,42139,21448,91515,24603,45335,61889,10712},{31953,2721,28082,
14171,13894,51336,2269,92039,77180,44949,5715,31212,8090,8056,94636,55469,33283,84171,12167,88614,61844,55212,77955,28398,35060,7116,70918,18441,86396,62420,69880,40102,80132,21785,63558,1991,34071,2139,25521,71259,42928,84258,82082,33105,32218,83089,92487,31029,98559,58137,59115,8995,92045,11058},{36340,41072,5753,34893,6614,6637,532,33647,75859,9885,75184,55654,21115,52426,69421,92688,22027,89345,84250,20834,26077,80836,3269,56420,39336,81278,22767,39405,45901,39981,35288,56610,7691,99964,39925,7363,83976,89355,18431,29500,47390,34124,34673,37630,8233,27237,94350,62594,17003,
70979,21530,91393,42717,90292},{16666,66276,49559,49778,31535,71998,18606,96194,57308,68882,2070,23405,43852,741,71880,45538,41053,64872,49138,58510,49018,80112,98127,9798,64569,38970,69365,14844,7026,55100,35411,77350,73009,42810,43085,72448,29458,62428,55262,41179,77850,81021,14752,99853,30137,56078,57534,92608,54061,60789,40949,90539,87044,40869},{40506,53159,54726,16937,81691,53903,15064,28828,99455,59952,73198,85533,13349,89094,96362,14160,76353,79956,16275,80055,23508,36530,5421,64772,9909,43538,95330,99270,43289,30144,92107,74383,57722,41505,68032,33220,532,53606,18503,68525,90136,75327,1129,58321,45006,39628,13503,7359,79772,55761,29182,54942,17518,90984},{21601,58864,16451,86316,18913,58954,6021,18375,
63005,73284,90165,26192,99472,9045,49469,8561,83067,59056,11204,76060,85082,67356,68799,5522,38688,11328,11441,45307,86854,60547,73839,26830,70987,75432,42171,46729,92851,78938,26207,36751,30483,78199,50755,61461,78143,23793,39758,44816,93301,98835,69712,70065,28731,23669},{72034,33000,11047,56987,22262,77691,83250,51305,9915,68150,1924,62447,57758,55682,38830,52855,88166,54665,71785,10254,38446,70713,89186,86230,80422,22922,66967,59063,25819,21382,56572,59459,63264,82895,66361,2023,60323,48735,16663,96365,88824,46446,14293,49316,94355,35255,27398,4488,33513,91072,47474,17626,19720,25671},{83086,29532,70749,21114,32444,32533,69683,22783,21213,80563,55089,
41987,87587,9118,95203,99058,34999,82976,30260,18628,80255,25973,67477,17692,43013,69887,47103,32840,90642,64731,64862,13394,19586,27290,67290,98742,88034,69255,81840,72474,81302,45807,64872,17529,39158,92135,89566,5921,307,59736,24845,32129,39141,21099},{3186,1464,89331,63742,85162,40030,95380,74735,7568,99686,31093,73719,98519,20589,59002,61112,83125,15277,51532,39352,83301,82533,66874,27823,66188,3266,30769,98862,30058,38313,28228,93191,94057,16376,54813,35716,95230,63406,6172,7491,16199,10197,84479,3516,34244,52671,32442,86768,34817,71218,34835,37450,59334,97659},{48675,16004,93085,75195,58503,56393,23972,86326,18983,51153,28259,34398,36365,64737,4300,13654,37181,59997,67306,95012,77418,59243,98544,4814,83722,
86839,78288,96793,96060,94598,12970,92525,16116,90149,25112,13602,95949,5431,31662,35831,27659,91117,38034,36012,43180,7613,7829,27272,92629,68631,36832,53224,72595,775},{55902,85089,54102,98457,59904,81690,93933,40815,58048,50798,55101,49997,70623,21736,14849,68211,59253,12322,51492,40565,90583,825,44848,91339,9014,23742,47014,2938,13555,77261,29061,91404,16995,38591,8523,81987,31115,13917,13610,59389,14027,57106,78956,40374,61476,11341,30803,51909,58129,98701,60334,26355,46474,95283},{29599,43142,93059,40760,87921,35666,92522,62528,65111,95476,7135,42019,10492,90067,46590,28084,41354,1754,59559,67787,87639,97515,38604,20337,32879,89312,74018,52528,11238,51795,65097,76411,11286,41198,59256,14096,41068,17512,9921,26361,33249,12011,
77209,11031,45506,62726,31842,37790,67489,9995,62620,94797,53564,90518},{1132,47153,83473,84481,59143,59354,90435,3200,28447,52291,52822,60150,75395,99149,11717,16159,56569,63220,80965,1533,46792,20394,20553,46891,27301,5655,15903,78264,96263,66383,75867,51709,25907,69957,63996,15608,43737,68046,4272,58531,29259,68325,63306,90957,65953,99456,13816,86568,2478,777,37141,27258,70248,85943},{8826,23767,86023,99210,77770,90260,17694,51514,21167,96564,59288,83439,37071,58036,9348,9669,14996,71091,11579,42656,21804,30294,53563,85076,75316,31072,80202,61234,37167,6181,96493,75641,63688,72279,72663,15087,99750,77606,74094,99721,50933,50987,7455,35277,5917,68885,86322,56752,56230,20934,92059,79049,44617,44029},{32658,60446,
2721,22894,87017,43398,57062,87492,225,56738,92020,7385,1627,16846,81248,2374,47362,98078,79441,22215,25938,19463,53608,41009,94423,17413,68860,465,89027,16474,96833,11503,98285,9982,18704,98080,36491,32218,96106,7204,45304,9486,10542,63862,27664,74490,44760,62720,39679,27112,10572,76913,70158,67368},{98314,93852,97098,9047,8930,2720,59123,83342,50131,67633,20633,3339,91416,88230,40133,5531,3914,99915,49202,82479,84199,58017,41362,38819,50021,86130,66016,58906,96815,9858,81029,14595,87588,19731,99202,4617,36502,19239,92845,70195,48787,74218,22551,93436,46917,71002,38153,15422,97576,73143,7985,52015,86610,22524},{62459,93051,36348,87623,59853,18266,4502,36833,66043,9399,41687,75767,4750,22298,30243,90079,46811,54598,42473,50948,34645,38925,26373,83677,76368,95161,54538,24,62924,70403,72698,89004,28010,83093,
73943,23037,16347,61889,59755,94079,35739,33685,93569,37301,90323,47124,52998,12397,55366,18844,18657,84747,98119,69755},{31262,52615,63952,75612,20162,60980,26333,35447,85149,73638,25398,45636,88734,87639,628,59710,63525,86647,93934,886,56904,5484,6418,81759,64738,29390,29050,85823,43934,89199,1101,30076,87631,10074,55259,13473,9842,24611,31198,79693,24301,53296,47014,86633,63478,29175,92679,21818,83802,32223,74948,32676,26480,66035},{77934,89405,75911,6969,30647,98092,18450,7590,71601,50851,41760,5778,75569,80570,36912,72833,70278,63139,9512,48884,12522,33324,85626,62131,64967,54885,51066,10820,20555,58115,9512,16040,51688,72067,4204,90146,88193,79845,50220,30161,83944,67152,67936,32463,23323,69857,9843,43835,
36784,54062,89348,63705,36326,68493},{72543,92247,98893,37769,48151,77217,81942,2238,54604,48524,6253,31694,37819,7614,17680,83523,5405,52146,172,27935,84610,84544,57817,54854,6911,20388,18388,6025,63519,69503,76489,93980,30099,62950,24275,56061,54387,95364,31384,75514,91259,21388,74686,84836,14150,95413,32380,96869,16782,34659,33443,29327,89849,23439},{69712,81787,26402,82728,92656,7838,222,32640,77311,93109,89108,70565,49982,78665,34310,74857,55789,14301,4267,11784,59373,64075,479,92723,1257,58682,63290,85268,77353,91624,52810,16310,56615,27637,35659,95232,13770,69774,34184,
82503,76785,90869,75131,46739,98442,3731,67656,97160,87131,66755,34059,9441,18344,343},{38498,4895,72381,81424,1099,85470,69019,84559,80171,45740,77653,27580,92083,71096,48752,58162,1261,37166,47156,37400,16507,42719,12677,63048,75865,18151,88107,7231,71209,9395,79057,895,89168,80389,18861,70122,28004,92049,80635,77980,18158,26160,92288,95884,7464,99630,62508,94521,74117,25832,97394,39494,33225,27119},{89897,34308,89779,91899,74349,49131,36227,39426,24491,52951,81150,57166,23999,50855,69543,13304,20602,46920,34079,97412,55184,98551,48062,50318,18204,65048,20508,53083,46793,70906,49621,47750,66511,72428,60586,66199,45612,43777,35176,41230,82103,50074,69418,63854,62567,62196,29058,91013,25047,95518,15803,84929,667,27725},{65585,56713,8581,17755,51672,15427,14775,73304,85465,83702,25311,8634,
23826,13393,19643,33327,6610,80336,65842,10580,75977,98752,17380,96884,94122,86530,18581,72741,61016,52306,9816,2120,90510,72919,45457,38106,4603,99993,29937,14733,70074,74282,8197,46302,47288,21215,29932,29578,74873,68969,16735,22245,61017,94695},{79375,57649,32438,94182,60634,29407,83637,1348,92413,10730,14388,22770,85189,69623,70550,64868,94882,37665,9816,85241,91459,67235,85990,59628,3380,63464,47632,58686,59123,53763,26437,75499,92902,51024,30779,90500,45368,17320,72679,39865,69055,51598,88839,57653,34431,59817,54105,18981,3773,99073,79071,61520,52015,76068},{45459,90862,74220,52309,2429,43451,54283,57807,55665,87651,8487,51311,37864,8974,19847,31201,
97947,86903,19111,68627,86750,51504,16858,34216,94865,60474,56083,91705,89393,37790,77612,63542,12679,39125,51795,95153,3423,37586,62009,78663,8042,44901,44865,38933,27091,80305,83459,60238,47028,26237,94610,64534,26315,89377},{93686,15035,48572,31327,77130,99600,71154,10145,4374,68541,32843,70203,36992,42862,60253,69177,14557,45273,1444,52301,40190,23068,31415,69830,13190,21454,69586,95678,44196,49283,47674,63658,91066,27603,3119,62353,22819,69958,884,38704,69629,56522,66939,98796,36246,69270,81887,77489,24871,76846,8746,98563,45074,37113},{49410,96642,36582,55570,45830,4320,2874,35734,82652,72215,47909,44484,36188,3387,72089,62718,80748,46617,91672,8568,38425,13118,243,67948,30305,17742,87030,60371,54306,98600,37810,16107,476,49652,30651,30644,32684,83030,70300,34773,17461,37900,24991,
38976,61284,71335,9598,62036,25433,65472,25497,61530,51706,45224},{17707,34528,56449,17656,43618,82837,24187,46906,74333,17806,91299,99630,50115,93970,32843,19543,59131,15617,23774,48286,50779,71634,22942,71235,2502,57441,60702,50977,62746,5235,56153,79942,54485,45566,87693,977,81849,13286,54020,81353,43280,28114,3128,62024,98513,95525,84437,45751,296,53776,60274,1830,49893,74656},{5440,77231,53558,41812,50494,55270,76477,92704,31613,12345,47634,84329,88124,38234,86088,21923,44017,2589,7463,15694,33465,47601,16543,59882,5263,81194,99722,63216,24545,54018,79358,29122,91881,77794,
65556,1011,15742,48680,65956,40361,16548,83603,49993,65562,7905,73916,73920,59097,9337,50401,38141,86678,84262,84019},{35795,55703,5909,1879,21628,88036,53777,95362,14437,72759,58419,87948,80140,8615,56499,76715,56714,19005,4485,72101,88016,79711,29653,72274,4251,70881,62804,29011,63952,19998,204,45540,39985,15626,54136,33543,83393,92955,21338,20655,24688,15066,32789,80866,47210,41911,61266,42331,14204,45824,24241,42452,43984,13718},{84535,46824,72960,38455,95685,78776,696,72991,57237,88692,95277,77130,64073,64025,90192,31005,4855,45448,28202,44147,18537,81205,47560,62793,86789,
18829,29944,13962,89297,75718,90019,63244,81246,9288,52392,96081,76226,61403,40936,39229,16336,92727,39401,40219,51520,16647,33168,57170,29253,85058,12418,61429,92004,78471},{98343,25843,40400,61752,73810,29041,23060,84840,6355,33595,25224,98748,69816,52392,28795,38296,63527,72183,25149,88506,34971,9141,81825,86334,95382,52520,80321,2664,98364,10393,33706,72133,84968,68641,84405,75809,59299,91329,9995,33845,41029,57728,54690,58729,90326,7978,57886,68608,52107,25794,89235,42543,30112,97422},{94410,56255,77025,9041,585,36522,50951,14295,45284,8060,35945,11346,29021,72289,90970,47537,7673,12265,37612,76649,63830,66650,80367,52465,24503,74488,13859,51205,40761,75732,68530,17088,64718,50419,25174,33198,2651,43929,15540,68520,49994,67692,
7929,2635,78729,8249,52250,61236,16586,88553,4384,35380,27303,42097},{4604,29672,51877,4576,21013,18403,90728,71146,95403,36231,20744,32385,39140,90556,66841,5788,87776,49927,16014,25138,11896,59639,16570,13689,86096,90170,91803,81944,55246,60781,22778,46297,44015,21886,92082,717,89892,62522,56691,62703,35806,63400,11716,68890,17235,25691,15322,52001,65809,15559,56431,71275,54630,22253},{56777,62189,16835,97271,97782,14796,41189,89105,54498,10037,70347,52917,41491,88612,77153,57889,10157,74371,51853,66075,89157,86502,9690,53216,99447,33284,31758,94594,45448,34357,4679,62427,72281,29076,66116,72457,45680,83835,24787,54313,25190,42927,12423,61138,11692,26545,76313,84639,26832,70658,85431,55706,58160,75171} };

    cout << lt.lt2577a(vv) << endl;

    return 0;
}
